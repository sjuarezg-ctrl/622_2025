---
title: "Problem Set 7"
subtitle: "Due date: 4 November"
format: 
  html:
    self-contained: true
toc: true
editor: visual
execute: 
  echo: true
  warning: false
---

```{r}
library("tidyverse")
library("modelsummary")
library("polisciols")
```

Please upload your completed assignment to the ELMs course site (under the assignments menu) and to your class Github repository. You need to upload both your Quarto document (with R code, as needed) and its rendered output (either as a PDF or HTML file).

**Total points: 20**

::: callout-note
15/20
:::

## Question 1

*Total points: 10*

I hypothesize that the older someone is, the more they like watching golf. I conduct a survey based on an SRS of adults in America. The independent variable is a four-category measure of age: 21-35, 36-50, 51-65, 66-plus. The dependent variable is a three-category measure of how much they enjoy watching golf: not at all, somewhat, very much.

### Part A

*Points: 4*

::: callout-note
2/4
:::

Make a cross-tab, by hand, of the relationship between these two variables based on the following (completely made up) data. Make sure that you present both raw counts and the appropriate percentages to examine the relationship.

```{r}
age_golf_df <- tibble::tibble(
  age = c("21-35", "51-65", "66-plus", "21-35", "36-50", "21-35", "36-50",
          "66-plus", "36-50", "51-65", "51-65", "21-35", "36-50", "21-35",
          "66-plus", "51-65", "36-50", "66-plus", "51-65", "21-35", "66-plus",
          "21-35", "36-50", "66-plus", "21-35", "36-50", "21-35", "66-plus",
          "51-65", "51-65", "66-plus", "21-35", "66-plus", "21-35", "51-65",
          "66-plus", "21-35", "36-50", "36-50", "66-plus"),
  preference = c("Somewhat", "Not at all", "Very much", "Not at all", "Somewhat",
                 "Not at all", "Not at all", "Somewhat", "Very much", "Very much",
                 "Somewhat", "Not at all", "Somewhat", "Very much", "Not at all",
                 "Not at all", "Somewhat", "Somewhat", "Very much", "Somewhat",
                 "Very much", "Somewhat", "Very much", "Somewhat", "Not at all",
                 "Very much", "Somewhat", "Somewhat", "Somewhat", "Very much",
                 "Not at all", "Not at all", "Very much", "Somewhat", "Very much",
                 "Very much", "Somewhat", "Somewhat", "Somewhat", "Not at all")
)

age_golf_df

datasummary_crosstab(age ~ preference, data = age_golf_df)
```

::: callout-note
You needed to calculate this by hand. You could not rely on the `datasummary_crosstab()` function.
:::

### Part B

*Points: 2*

::: callout-note
1/2
:::

Do the data support my hypothesis? Be sure to explain the nature of the relationship (or lack thereof, if relevant).

Answer: The data does support the hypothesis, as the age groups increased so did the number of people who enjoyed golf. This can be seen for example with then 36-50 and 51-65 groups where less than 30% chose "Not at all" and more than half went with either "somewhat"or "very much."

::: callout-note
The data do not indicate a linear positive relationship.
:::

### Part C

*Points: 2*

::: callout-note
2/2
:::

Compute (by hand) the chi-square statistic to test the null hypothesis of no relationship between these two variables. Be sure to show your work.

```{r}

obs_values <- count(age_golf_df, age, preference, name = "obs_n")

age_totals <- count(age_golf_df, age, name = "age_totals")

preference_totals <- count(age_golf_df, preference, name = "preference_totals")

N <- nrow(age_golf_df)

expected_values <- obs_values |>
  left_join(age_totals, by = "age") |>
  left_join(preference_totals, by = "preference") |>
  mutate(exp_n = (age_totals * preference_totals) / N)

chi_square <- sum((expected_values$obs_n - expected_values$exp_n)^2 / expected_values$exp_n)
chi_square

p_value <- pchisq(chi_square, df = 6, lower.tail = FALSE)
p_value



```

### Part D

*Points: 2*

::: callout-note
1/2
:::

Using the chi-square statistic that you computed in question 1(c), can you reject the null hypothesis of no relationship between these two variables with 95% confidence? Why, or why not?

Answer: Given that the p-value is larger than the 0.05, then we can accept the null hypothesis that there is no relationship between age and enjoyment of watching golf.

::: callout-note
We never find evidence of the null hypothesis. We can only find (insufficient) evidence of the alternative hypothesis. So, here, you cannot reject the null hypothesis based on the data.
:::

## Question 2

*Points: 10*

::: callout-note
9/10
:::

I hypothesize that people with higher levels of education tend to be more likely to pay higher levels of attention to politics. Use the `nes2024` dataset from the `polisciols` package to test my hypothesis. Create a cross-tab examining the relationship between individuals' levels of education (`education`) and the time they spend paying attention to politics (`attention_to_politics`).

**Cross-tab:**

```{r}

datasummary_crosstab(education ~ attention_to_politics, data = nes2024)

```

Do the data support my hypothesis? Be sure to explain the nature of the relationship (or lack thereof, if relevant). Report a chi-square statistic. What does the chi-square statistic tell you about whether you can reject the null hypothesis of no relationship between these two variables with 95% confidence? Why, or why not?

Answer: The data does support the hypothesis that higher education leads to an increase in attention paid to politics. As education increased, there tends to be a higher percentage of people paying attention to politics.

::: callout-note
Be a little careful with your interpretation. Your language is causal: "As education increased, there tends to be a higher percentage of people paying attention to politics." A more accurate interpretation is: "Individuals with higher levels of education tended to pay more attention to politics compared to individuals with lower levels of education".
:::

**chi-square:**

```{r}
chisq.test(nes2024$education, nes2024$attention_to_politics)
```

Given that the p-value is much smaller than 0.05, then the null hypothesis can be rejected at the 95% confidence interval.
