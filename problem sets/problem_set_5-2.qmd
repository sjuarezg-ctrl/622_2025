---
title: "Problem Set 5"
subtitle: "Due date: 21 October"
format: 
  html:
    self-contained: true
toc: true
editor: visual
execute: 
  echo: true
---

Please upload your completed assignment to the ELMs course site (under the assignments menu) and to your class Github repository. You need to upload both your Quarto document (with R code, as needed) and its rendered output (either as a PDF or HTML file).

**Total points: 25**

::: callout-note
23/25
:::

```{r}
library(tidyverse)
```

## Question 1

*Total points: 6*

Use the data in the table below to answer the following questions.

```{r}
#| echo: false

tibble::tibble(
  `Age group` = c("18-24", "25-30", "31 and up", "TOTAL"),
  `Non-voters` = c(70, 40, 220, 330),
  Voters = c(50, 50, 570, 670),
  Total = `Non-voters` + Voters
) |> 
  knitr::kable(caption = "Voting by Age in 2000")
```

### Part A

*Points: 2*

::: callout-note
2/2
:::

What is the probability of being 25-30 or a non-voter?

```{r}
(90 + 330 - 40)/1000
```

Answer: Probability is 0.38

### Part B

*Points: 4*

::: callout-note
2/4
:::

Assuming a normal distribution, report the 95% confidence intervals for the percentage of 18-to-24-year-olds who did not vote, and then the percentage of 25-to-30-year-olds who did not vote.

```{r}
(70/120) + 1.96*sqrt((70/120 * (1 - 70/120))/120)
```

```{r}
(70/120) - 1.96*sqrt((70/120 * (1 - 70/120))/120)
```

```{r}
(40/90) + 1.96*sqrt((40/90*(1-40/90))/90)
```

```{r}
(40/90) - 1.96*sqrt((40/90*(1-40/90))/90)
```

The percentage of 18-24 year olds who did not vote had a 95% confidence interval of 49.51% to 67.15%

The percentage of 25-30 year olds who did not vote had a 95% confidence interval of 34.18% to 54.71%

## Question 2

*Total points:* *7*

Assume that the standard deviation for the population distribution of a state in which you want to conduct a poll is 200.

### Part A

*Points: 3*

::: callout-note
3/3
:::

Calculate the spread of the sampling distribution for each of the following sample sizes: 1, 4, 25, 100, 250, 1000, 5,000, and 10,000.

```{r}
sigma <- 200

n <- c(1, 4, 25, 100, 250, 1000, 5000, 10000)

SE <- sigma / sqrt(n)

results <- data.frame(
  Sample_Size = n,
  Standard_Error = round(SE, 2)
)

print(results)

```

### Part B

*Points: 1*

::: callout-note
1/1
:::

Describe specifically how the variability of the sampling distribution changes as the sample size varies. Considering the expense of running a poll, which sample size do you think is most optimal if conducting the poll?

As the sample size increases, the variability decreases. Giving the expense of conducting a poll, 1000 would be a good sample size given that it can still provide a small standard error.

### Part C

*Points: 3*

::: callout-note
3/3
:::

Display your results graphically (using R) with the sample size on the x-axis and the standard error (of the sampling distribution) on the y-axis.

```{r}
ggplot(results, aes(x = Sample_Size, y = Standard_Error)) +
  geom_point() +         
  geom_line() +     
  scale_x_log10() +                              
  labs(
    title = "Effect of Sample Size on Standard Error",
    x = "Sample Size",
    y = "Standard Error of Sampling Distribution"
  ) +
  theme_minimal()
```

## Question 3

*Points: 4*

::: callout-note
4/4
:::

Suppose you conduct a survey (to generate a sample mean of interest) and find that it has a margin of error of 4.5 with a sample size of 900 using a 95% confidence interval. What would the margin of error be for a 90% confidence interval?

```{r}
n <- (4.5/1.96)*30

1.645*n/sqrt(900)
```

Margin of Error would be 3.776786

## Question 4

*Points: 4*

::: callout-note
4/4
:::

Assume that, in State A, the mean income in the population is \$20,000 with a standard deviation of \$2,000. If you took an SRS of 900 individuals from that population, what is the probability that you would get a sample mean income of \$20,200 or greater? What would be the probability if the sample size was only 25?

```{r}
n1<-2000/sqrt(900)
(20200-20000)/n1

1-0.99865

n2 <- 2000/sqrt(25)
(20200-20000)/n2

1-0.6915

```

The probability for a sample of 900 would be 0.00135. The probability for a sample of 25 would b e 0.3085.

::: callout-note
Assume a normal distribution for both questions.
:::

## Question 5

*Points: 4*

::: callout-note
4/4
:::

Assume that a coin is fair. If I flip a coin 500 times, what is a 95% confidence interval for the range of the count of heads that I will get? What if I flip the coin 5,000 times? What about 50,000 times?

```{r}
(0.5 + 1.96*sqrt(0.5*(1-0.5)/500)) * 500
(0.5 - 1.96*sqrt(0.5*(1-0.5)/500)) * 500

(0.5 + 1.96*sqrt(0.5*(1-0.5)/5000)) * 5000
(0.5 - 1.96*sqrt(0.5*(1-0.5)/5000)) * 5000

(0.5 + 1.96*sqrt(0.5*(1-0.5)/50000)) * 50000
(0.5 - 1.96*sqrt(0.5*(1-0.5)/50000)) * 50000
```

For 500 times the interval would be 228 through 272. For 5000 times the interval would be 2431 to 2569. For 50000 times the interval would be 24781 to 25219.
