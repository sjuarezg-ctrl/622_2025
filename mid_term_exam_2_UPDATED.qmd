---
title: "Mid-term Exam #2"
subtitle: "Due date: 6 November"
format: 
  html:
    self-contained: true
toc: true
editor: visual
execute: 
  echo: true
  message: false
  warning: false
---

```{r}
library(tidyverse)
library(polisciols)
```

Please read all of the questions carefully and follow all instructions. Each question has an allotted point value. Be as thorough and specific as possible; extra calculations and incorrect information, even in the presence of correct information, will result in point deductions. Be sure to show all formulas and all necessary work to answer the questions. You may upload your completed exam to the Elms course site (attach to Midterm Exam #2).

::: callout-note
While this is an open-note exam, you are not to receive assistance from anyone else (as usual, the Honor Code applies).
:::

**Total points: 50 points**

## Conceptual questions

::: callout-note
Please include all work (and computations) necessary to answer the questions.
:::

**Total points: 26**

### Question 1

*2 points*

::: callout-note
1/2 You lost one point for using the **Z-score** ($qnorm(0.95)$) instead of the **t-statistic**.
:::

Suppose I am interested in determining if freshman undergraduates at the University of Maryland spend more hours studying in the average week than sophomore undergraduates. I conduct a study in which I take a simple random sample (SRS) of 1200 freshman students and 1200 sophomore students. I find that the freshman students in my sample study for, on average, 412 minutes per week and the sophomore students in my sample study for, on average, 335 minutes per week. The standard error of the difference is 30. What is a 90% confidence interval for the difference between freshman and sophomore students?

```{r}

diff <- 412 - 335     
SE <- 30            
z <- qnorm(0.95)    

lower <- diff - z * SE
upper <- diff + z * SE

c(lower, upper)


```

We are 90% confident that freshman study between 27.6 minutes and 126.3 minutes more per week than sophomores on average.

### Question 2

*2 points*

::: callout-note
1/2 You correctly rejected the null hypothesis based on the small $p$-value ($0.010 < 0.10$). However, for a difference-of-means test, you should use the $t$-statistic with the appropriate degrees of freedom, not the $Z$-score. Because you referred to the $Z$-score in your calculation and justification, you lose 1 point.
:::

Based on the results of my study described in question 1, can you reject the null hypothesis of no statistically meaningful difference in the study habits of sophomore and freshman students? Why or why not?

```{r}
diff <- 412 - 335    
SE <- 30             

z <- diff / SE

p_value <- 2 * (1 - pnorm(abs(z)))

p_value


```

Given that the p value (0.010) is smaller than the significance level (0.10) then we can reject the null hypothesis.

### Question 3

*2 points*

::: callout-note
2/2
:::

If I am testing a null hypothesis that X has no effect on Y in the population (and thus my alternative hypothesis is that X does have an effect), why might I prefer to commit a Type-II error over a Type-I error (and, of course, this holds aside my first preference of making no error at all)? Answer in no more than two sentences.

A type I error will incorrectly identify a relationship that does not exist which in turn can lead to incorrect theories, conclusions, or waste of future resources. A type II error is preferable because while the initial relationship may be missed, there is opportunity to discover it with further research.

### Question 4

*1 point*

::: callout-note
1/1
:::

When conducting a difference-of-means test, which of the following samples would yield a sampling distribution with the lowest variability?

A.  A sample of 900 with a standard deviation of 15
B.  A sample of 25 with a standard deviation of 10
C.  A sample of 625 with a standard deviation of 20
D.  A sample of 100 with a standard deviation of 6

A, the sample of 900 with a standard deviation of 15 will lead the lowest standard error.

### Question 5

*1 point*

::: callout-note
1/1
:::

Which of the following probabilities is not independent?

A.  The probability that the roulette wheel will end up on 23 two times in a row.
B.  The probability that three successive coin tosses will each turn up heads.
C.  The probability that I draw an ace and then a king in a row from a deck of cards (when drawing a two-card hand).
D.  The probability that I will get a 6 on three subsequent die rolls.
E.  None of the above – all are independent probabilities.

C, drawing an Ace

### Question 6

*1 point*

::: callout-note
1/1
:::

I conduct a two-tailed difference-of-means test and obtain a t-statistic of 2.10. Is my result statistically significant (with 95% confidence)?

A.  Yes, at the 0.05 level (p\<0.05)
B.  Yes, but only at the 0.10 level (p\<0.10)
C.  Not at either the 0.05 or the 0.10 level
D.  There is not enough information to answer this question.

Answer is D, degress of freedom are needed

### Question 7

*1 point*

::: callout-note
1/1
:::

I take a sample of 1800 adults and find that 360 of them watched last Monday’s NFL game. What probability represents the complement to the sample proportion of adults who watched the NFL game?

```{r}
n <- 1800

watched <- 360

p_hat <- watched / n

p_complement <- 1 - p_hat

p_complement


```

The complement probability will be 0.80.

### Question 8

*1 point*

::: callout-note
0/1

While **more observations (A)** is correct because it reduces the Standard Error (SE), **greater variance in the sample (B)** is incorrect. Greater variance *increases* the Standard Error, which *decreases* the likelihood of statistical significance (all else equal). The correct answer is A.
:::

Which of the following makes it more likely that a given sample statistic will be statistically different from zero (and thus allow you to reject the null hypothesis, all else equal)?

A.  More observations
B.  Greater variance in the sample
C.  Using a two-tailed instead of a one-tailed significance test
D.  A larger confidence interval around the test statistic
E.  Both (a) and (b) (but not (c) or (d))
F.  All of the above increase the chances of statistical significance
G.  None of the above

Answer is E

### Question 9

*1 point*

::: callout-note
1/1
:::

The p-value for a two-tailed test of the null hypothesis $H_0: \mu=40$ is 0.06. Which of the following statements is accurate?

A.  A 95% confidence interval around the sample mean includes the value 40
B.  A 90% confidence interval around the sample mean includes the value 40
C.  A 99% confidence interval around the sample mean does not include the value 40
D.  None of the above statements are correct
E.  All of the above statements are correct

Answer is A

### Question 10

*4 points total*

#### Part A

*2 points*

::: callout-note
2/2
:::

If you roll a fair (six-sided) die twice, what is the probability that both rolls will be odd or greater than four?

```{r}
p_single <- length(c(1, 3, 5, 6)) / 6

p_both <- p_single^2

p_both


```

The probability that BOTH rolls will be odd or greater than four is 0.44

#### Part B

*2 points*

::: callout-note
2/2
:::

The following is a distribution of U.S. college students classified by their age and full- vs. part-time status. Based on these data, what is the probability that a student is in the 25-29 age group, given that (i.e., conditional on knowledge that) the student is full time?

```{r}
tibble::tibble(
  age = c("15 - 19", "20 - 24", "25 - 29", "30+"),
  full_time = c(155, 255, 75, 35),
  part_time = c(20, 55, 80, 95)
) |> 
  knitr::kable()
```

```{r}
library(dplyr)

students <- tibble::tibble(
  age = c("15 - 19", "20 - 24", "25 - 29", "30+"),
  full_time = c(155, 255, 75, 35),
  part_time = c(20, 55, 80, 95)
)

P_25_29_given_full <- students %>%
  summarise(prob = full_time[age == "25 - 29"] / sum(full_time)) %>%
  pull(prob)

P_25_29_given_full


```

The probability that a student is in the 25-29 age range given that they are full time is 0.1442308

### Question 11

*4 points total*

#### Part A

*2 points*

::: callout-note
2/2
:::

Using a SRS of 1211 people, I estimate that the proportion of people living in the South that favor teaching sexual education in public schools is 0.874 and the proportion of people outside of the south that favor teaching sexual education in public schools is 0.906. And, the standard error of the difference (in citizen views about teaching sexual education in public schools) between people living in the south and those not living in the south is 0.015. Give an interval estimate for the difference in the proportion of people favoring sex education in public schools between people who do, and do not, live in the south.

```{r}

p_south <- 0.874
p_notsouth <- 0.906
SE <- 0.015
z <- qnorm(0.975)

diff <- p_south - p_notsouth

lower <- diff - z * SE
upper <- diff + z * SE

c(lower, upper)


```

A 95% confidence interval for the difference in the proportion of people favoring sex education in public schools between those who do or not live in the south would be -0.061 and -0.003

#### Part B

*2 points*

::: callout-note
2/2
:::

Do the data (i.e., estimates above) show support for my hypothesis? How do you know?

```{r}
diff <- -0.032
SE <- 0.015

z <- diff / SE

p_value <- 2 * (1 - pnorm(abs(z)))
p_value


```

Given that the p value (0.033) is smaller than the significance level of 0.05, then we can reject the null hypothesis that there is no difference. Therefore, the data does support your hypothesis that living in the South leads to lower support.

### Question 12

*6 points total*

I am interested in estimating the average number of texts that University of Maryland undergraduate students send in a day. My hypothesis is that the average number of texts students send is greater than 100. I take a SRS of 1600 students and find that the mean number of texts they send is 105, and with a standard deviation of 120.

#### Part A

*2 points*

::: callout-note
1/2 This question involves means, so you need to use the $t$-statistic, not the $Z$-score.
:::

What is a 95% confidence interval around the sample statistic?

```{r}
x_bar <- 105
s <- 120
n <- 1600
z <- qnorm(0.975)  

SE <- s / sqrt(n)

lower <- x_bar - z * SE
upper <- x_bar + z * SE

c(lower, upper)


```

A 95% confidence interval around the sample statistic is 99.12 and 110.88.

#### Part B

*2 points*

::: callout-note
1/2 You incorrectly used the $Z$-score, not the $t$-statistic.
:::

When testing the null hypothesis, what is the test statistic associated with the sample statistic?

```{r}
x_bar <- 105
mu0 <- 100
s <- 120
n <- 1600

SE <- s / sqrt(n)
z <- (x_bar - mu0) / SE
z

```

When testing for the null hypothesis, the test statistic would be 1.667

#### Part C

*2 points*

::: callout-note
2/2
:::

If using a one-tailed test of the null hypothesis and you are willing to accept a Type-I error rate of 0.05, do the data support my hypothesis? Why or why not?

```{r}
x_bar <- 105   
mu0 <- 100     
s <- 120       
n <- 1600      
alpha <- 0.05  

SE <- s / sqrt(n)

z <- (x_bar - mu0) / SE


z_crit <- qnorm(1 - alpha)

p_value <- 1 - pnorm(z)

p_value

```

Given that the p value calculated will be less than 0.05, then the null hypothesis can be rejected and in turn your hypothesis can be accepted.

## Applied questions

::: callout-note
All datasets referenced below are available through the `poliscidata` package.
:::

**Total points: 24**

### Question 1

```{r}

gss <- poliscidata::gss |> 
  mutate(voted08 = as.numeric(voted08),
         conarmy = as.numeric(conarmy))

gss_eligible <- poliscidata::gss |>
  filter(!is.na(voted08), !is.na(conarmy)) |>
  mutate(vote08 = as.numeric(voted08),
         conarmy = as.numeric(conarmy))
```

*8 points total*

I hypothesize that, among only those that were eligible to vote, people with greater confidence in the U.S. military were more likely to turnout to vote in the 2008 presidential election. Use data from the General Social Survey (i.e., the `gss` dataset) to test my hypothesis (the unit of analysis is the individual survey respondent). Specifically, use the following variables: `conarmy` (1 = a “great deal” of confidence; 2 = “only some” confidence; 3 = “hardly any”); and `vote08` (1 = did not vote; 2 = voted). Answer the following questions.

#### Part A

*3 points*

::: callout-note
0/3 You failed to complete a cross-tab and fully interpret the results by explaining the *nature* of the relationship with the column percentages. You must include the cross-tab or the column percentages for the voted category to show the graded relationship.
:::

Complete a cross-tab and interpret the results. Do the data support my hypothesis? Be sure to explain the nature of the relationship (or lack thereof, if relevant).

```{r}
table(gss_eligible$conarmy, gss_eligible$voted08)

```

The data does support the hypothesis that those who had more faith in the government were more likely to vote.

#### Part B

*3 points*

::: callout-note
3/3
:::

Compute (by hand) the chi-square statistic to test the null hypothesis of no relationship between these two variables. Be sure to show your work.

```{r}

library(dplyr)

observed <- count(gss_eligible, voted08, conarmy, name = "observed")

voted <- count(gss_eligible, voted08, name = "vote_total")

army <- count(gss_eligible, conarmy, name = "army_total")

N <- nrow(gss_eligible)


counts <- voted |>
  full_join(army, by = character()) |>
  mutate(expected = (vote_total * army_total) / N) |>
  left_join(observed, by = c("voted08", "conarmy")) |>
  mutate(
    observed = ifelse(is.na(observed), 0, observed),
    diff = observed - expected,
    diff2 = diff^2,
    contrib = diff2 / expected
  )

counts %>% select(voted08, conarmy, observed, expected, contrib)

chi_sq <- sum(counts$contrib)
chi_sq




```

The chi square statistic will be 6.01

#### Part C

*2 points*

::: callout-note
2/2
:::

Using the chi-square statistic that you computed in question 1(b), can you reject the null hypothesis of no relationship between these two variables with 95% confidence? Why, or why not?

```{r}
O <- xtabs(observed ~ voted08 + conarmy, data = counts)

df <- (nrow(O) - 1) * (ncol(O) - 1)

crit_95 <- qchisq(0.95, df)
crit_95


```

Given that the chi square statistic calculated is greater than the critical value, then the null hypothesis can be rejected with 95% confidence. There is evidence at hand that there is a significant relationship between people's confidence in the U.S military and how they voted in the 2008 election.

### Question 2

```{r}

nes <- poliscidata::nes |> 
  dplyr::mutate(envir_drill = factor(envir_drill, levels = c("1. Favor",
                                                             "3. Neither favor nor oppose",
                                                             "2. Oppose")),
                envir_drill = as.numeric(envir_drill),
                pid_x = as.numeric(pid_x),
                relig_pray = as.numeric(relig_pray),
                voted2008 = as.numeric(voted2008))
```

*8 points total*

I hypothesize that citizens who do not support increased U.S. offshore drilling are more conservative than those who do not. Use data from the `nes` dataset to test my hypothesis (the unit of analysis is the individual survey respondent). Specifically, use the following variables: `envir_drill` (1 = “favor”; 2 = “neither favor nor oppose”; 3 = “oppose”); and `pid_x` (higher values represent less liberalism, or more conservatism). Answer the following questions.

#### Part A

*2 points*

::: callout-note
2/2
:::

Using these data, what is the point estimate for the mean conservatism/liberalism score among those that oppose drilling? What is the point estimate for the mean conservatism/liberalism score among those that are in favor of drilling?

```{r}
library(dplyr)

nes_means <- nes |>
  filter(!is.na(envir_drill), !is.na(pid_x)) |>
  group_by(envir_drill) |>
  summarise(mean_pid = mean(pid_x, na.rm = TRUE))

nes_means


```

The point estimate for the mean score for those that oppose drilling is 2.64, the point estimate for the mean score for those who are in favor of drilling is 4.18

#### Part B

*6 points*

::: callout-note
6/6
:::

Evaluate the null hypothesis that there is no difference in the mean conservatism/liberalism score among those that approve vs. disapprove of drilling. Do the data support my hypothesis? Why or why not? Be sure to show all work necessary to answer the question by hand (i.e., you may only use R to the extent that is absolutely necessary to complete the question; otherwise, you must show how you would answer the question by hand).

```{r}
library(dplyr)

standard_error <- sqrt(1.689037^2 / 1060 + 2.186845^2/3069)

t_stat <- (2.636792 - 4.179537)/ standard_error

p_value <- 2*pt(t_stat, df= 1060-1, lower.tail = T)

p_value

```

Given that the P-value (9.912213e-100) is so small, then we can reject the null hypothesis of no difference. However, the data does not support the initial hypothesis put forward.

### Question 3

*8 points total*

I hypothesize that people who express that religion is important to them were more likely to turnout to vote in the 2008 presidential election. Use data from the `nes` dataset to test my hypothesis (the unit of analysis is the individual survey respondent). Specifically, use the following variables: `relig_pray`, which describes how often the respondent prays (1 = several times a day; 2 = once a day; 3 = a few times a week; 4 = once a week or less; 5 = never); and `voted2008` (1 = did not vote; 2= voted). Answer the following questions.

#### Part A

*2 points*

::: callout-note
1/2 You used the wrong `relig_pray` coding. `relig_pray == 1` refers to those who pray every day (and think it is important). `relig_pray == 5` refers to those who never pray (and think it is not important).
:::

Using these data, what is the point estimate for the proportion of respondents that voted (i.e., turnout rate), among citizens expressing that religion is not important? What is the point estimate for the proportion of respondents that voted, among citizens expressing that religion matters a great deal?

```{r}
library(dplyr)

nes_voter <- nes %>%
  filter(!is.na(voted2008), !is.na(relig_pray))

prop_not_important <- nes_voter %>%
  filter(relig_pray == 1) %>%
  summarise(p_voted = mean(voted2008 == 2)) %>%
  pull(p_voted)


prop_great_deal <- nes_voter %>%
  filter(relig_pray == max(relig_pray, na.rm = TRUE)) %>%
  summarise(p_voted = mean(voted2008 == 2)) %>%
  pull(p_voted)

prop_not_important
prop_great_deal



```

The point estimate for those who expressed that religion was not important was 0.82. The point estimate for those who said that religion was a great deal was 0.72.

#### Part B

*6 points*

::: callout-note
5/6 By incorrectly interpreting the `relig_pray` variable, you used the wrong observation counts. However, you ended up with the right answer (reject the null hypothesis).
:::

Evaluate the null hypothesis that there is no difference in the proportion of voters (i.e., turnout rate) among citizens expressing that religion is not important vs. those reporting that religion matters a great deal. Do the data support my hypothesis? Why or why not? Be sure to show all work necessary to answer the question by hand (i.e., you may only use R to the extent that is absolutely necessary to complete the question; otherwise, you must show how you would answer the question by hand).

```{r}

phat <- (1445 + 687)/(1753 +949)

standard_e <- sqrt(phat * (1-phat)*(1/1753+1/949))

z_stat <- (0.724-0.824)/standard_e

2 * pnorm(z_stat, lower.tail = T)

```

We can reject the null hypothesis given that the p- value is so small. In turn this means that the alternate hypothesis can be supported.
